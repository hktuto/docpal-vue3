{"widgetList":[{"key":9512,"type":"select","icon":"select-field","formItemFlag":true,"options":{"name":"idOrPath","label":"collections_caption","labelAlign":"","defaultValue":"","placeholder":"collections_caption","columnWidth":"200px","size":"","labelWidth":null,"labelHidden":false,"disabled":false,"hidden":false,"clearable":true,"filterable":true,"allowCreate":true,"remote":false,"automaticDropdown":false,"multiple":false,"multipleLimit":0,"optionItems":[],"required":false,"requiredHint":"","validation":"","validationHint":"","customClass":[],"labelIconClass":null,"labelIconPosition":"rear","labelTooltip":null,"onCreated":"","onMounted":"const _this = this\ngetCollections()\nasync function getCollections () {\n  const data = await $api.get('/nuxeo/collection/all').then(res => res.data.data)\n  const collectionList = data.reduce((prev,item) => {\n    if (item.id) prev.push({\n      label: item.name,\n      value: item.id\n    })\n    return prev\n  }, [])\n  _this.loadOptions(collectionList)\n}","onRemoteQuery":"","onChange":"// let text = ''\n// if(value) {\n//   const list = this.getOptionItems()\n//   const index = list.find(item => item.label === value)\n//   text = index === -1 ? '' : `+ ${$t('collection.newText')}: ${value}`\n// }\n// const newText = this.getWidgetRef('newText')\n// newText.setWidgetOption('textContent', text)","onFocus":"","onBlur":"","onValidate":""},"id":"select71942"},{"key":76931,"type":"grid","category":"container","icon":"grid","cols":[{"type":"grid-col","category":"container","icon":"grid-col","internal":true,"widgetList":[{"key":17472,"type":"static-text","icon":"static-text","formItemFlag":false,"options":{"name":"newText","columnWidth":"200px","hidden":false,"textContent":"","textAlign":"left","fontSize":"13px","preWrap":false,"customClass":[],"onCreated":"","onMounted":"","label":"static-text"},"id":"statictext66752"}],"options":{"name":"gridCol63201","hidden":false,"span":18,"offset":0,"push":0,"pull":0,"responsive":false,"md":12,"sm":12,"xs":12,"customClass":[]},"id":"grid-col-63201"},{"type":"grid-col","category":"container","icon":"grid-col","internal":true,"widgetList":[{"key":89112,"type":"button","icon":"button","formItemFlag":false,"options":{"name":"submit","label":"submit","columnWidth":"200px","size":"","displayStyle":"block","disabled":false,"hidden":false,"type":"primary","plain":false,"round":false,"circle":false,"icon":null,"customClass":["right"],"onCreated":"","onMounted":"this.setDisabled(false)","onClick":"const _this = this\nconst idOrPathRef = this.getWidgetRef('idOrPath')\nconst selectedValue = idOrPathRef.getValue()\nconst collections = idOrPathRef.getOptionItems() \nconst index = collections.findIndex(item => item.value === selectedValue)\nhandleSubmit()\nasync function handleSubmit() {\n  _this.setDisabled(true)\n  let idOrPath = selectedValue\n  if (index === -1) {\n    const data = await createCollectionApi(selectedValue)\n    idOrPath = data.id\n    getCollections()\n  }\n  const vform = _this.getFormRef()\n  vform.$emit('emit', 'handleSubmit', {\n    idOrPath\n  })\n}\nasync function createCollectionApi(name) {\n  return await $api.post('/nuxeo/collection/create', { name }).then(res => res.data.data)\n}\nasync function getCollections () {\n  const data = await $api.get('/nuxeo/collection/all').then(res => res.data.data)\n  const collectionList = data.reduce((prev,item) => {\n    if (item.id) prev.push({\n      label: item.name,\n      value: item.id\n    })\n    return prev\n  }, [])\n  idOrPathRef.loadOptions(collectionList)\n}"},"id":"button15356"}],"options":{"name":"gridCol52744","hidden":false,"span":6,"offset":0,"push":0,"pull":0,"responsive":false,"md":12,"sm":12,"xs":12,"customClass":[]},"id":"grid-col-52744"}],"options":{"name":"grid84645","hidden":false,"gutter":12,"colHeight":null,"customClass":[]},"id":"grid84645"}],"formConfig":{"modelName":"formData","refName":"vForm","rulesName":"rules","labelWidth":80,"labelPosition":"top","size":"","labelAlign":"label-left-align","cssCode":".right{\n  float: right;\n}","customClass":[],"functions":"","layoutType":"PC","jsonVersion":3,"onFormCreated":"","onFormMounted":"","onFormDataChange":"","onFormValidate":"","saveRemoteOptions":"never","labelFormUniqueName":true,"dataSources":[]}}