{"widgetList":[{"key":73467,"type":"grid","category":"container","icon":"grid","cols":[{"type":"grid-col","category":"container","icon":"grid-col","internal":true,"widgetList":[{"key":80927,"type":"input","icon":"text-field","formItemFlag":true,"options":{"name":"policyName","label":"hp.policyName","labelAlign":"","type":"text","defaultValue":"","placeholder":"","columnWidth":"200px","size":"","labelWidth":null,"labelHidden":false,"readonly":false,"disabled":false,"hidden":false,"clearable":true,"showPassword":false,"required":true,"requiredHint":"","validation":"","validationHint":"","customClass":[],"labelIconClass":null,"labelIconPosition":"rear","labelTooltip":null,"minLength":null,"maxLength":null,"showWordLimit":false,"prefixIcon":"","suffixIcon":"","appendButton":false,"appendButtonDisabled":false,"buttonIcon":"custom-search","onCreated":"","onMounted":"","onInput":"","onChange":"","onFocus":"","onBlur":"","onValidate":"","onAppendButtonClick":""},"id":"input53675"}],"options":{"name":"gridCol79996","hidden":false,"span":24,"offset":0,"push":0,"pull":0,"responsive":false,"md":12,"sm":12,"xs":12,"customClass":[]},"id":"grid-col-79996"},{"type":"grid-col","category":"container","icon":"grid-col","internal":true,"widgetList":[{"key":47126,"type":"input","icon":"text-field","formItemFlag":true,"options":{"name":"periodNum","label":"rp.period","labelAlign":"","type":"text","defaultValue":"","placeholder":"","columnWidth":"200px","size":"","labelWidth":null,"labelHidden":false,"readonly":false,"disabled":false,"hidden":false,"clearable":true,"showPassword":false,"required":true,"requiredHint":"","validation":"number","validationHint":"","customClass":[],"labelIconClass":null,"labelIconPosition":"rear","labelTooltip":null,"minLength":null,"maxLength":10000,"showWordLimit":false,"prefixIcon":"","suffixIcon":"","appendButton":false,"appendButtonText":"","appendButtonDisabled":false,"buttonIcon":"custom-search","onCreated":"","onMounted":"","onInput":"","onChange":"","onFocus":"","onBlur":"","onValidate":"","onAppendButtonClick":""},"id":"input47870"}],"options":{"name":"gridCol58113","hidden":false,"span":20,"offset":0,"push":0,"pull":0,"responsive":true,"md":19,"sm":12,"xs":14,"customClass":[]},"id":"grid-col-58113"},{"type":"grid-col","category":"container","icon":"grid-col","internal":true,"widgetList":[{"key":39877,"type":"select","icon":"select-field","formItemFlag":true,"options":{"name":"periodUnit","label":"periodUnit","labelAlign":"","defaultValue":"Y","placeholder":"","columnWidth":"200px","size":"","labelWidth":null,"labelHidden":false,"disabled":false,"hidden":false,"clearable":true,"filterable":false,"allowCreate":false,"remote":false,"automaticDropdown":false,"multiple":false,"multipleLimit":0,"optionItems":[{"label":"common_years","value":"Y"},{"label":"common_months","value":"M"},{"label":"common_days","value":"D"}],"required":true,"requiredHint":"","validation":"","validationHint":"","customClass":["opacityLabel"],"labelIconClass":null,"labelIconPosition":"rear","labelTooltip":null,"onCreated":"","onMounted":"","onRemoteQuery":"","onChange":"","onFocus":"","onBlur":"","onValidate":""},"id":"select102460"}],"options":{"name":"gridCol16288","hidden":false,"span":4,"offset":0,"push":0,"pull":0,"responsive":true,"md":5,"sm":12,"xs":10,"customClass":[]},"id":"grid-col-16288"},{"type":"grid-col","category":"container","icon":"grid-col","internal":true,"widgetList":[{"key":77069,"type":"switch","icon":"switch-field","formItemFlag":true,"options":{"name":"actionType","label":"dpTable_actions","labelAlign":"label-left-align","defaultValue":false,"columnWidth":"200px","labelWidth":null,"labelHidden":false,"disabled":false,"hidden":false,"customClass":[],"labelIconClass":null,"labelIconPosition":"rear","labelTooltip":null,"switchWidth":40,"activeText":"Delete","inactiveText":"Archive","activeColor":null,"inactiveColor":null,"onCreated":"","onMounted":"","onChange":"","onValidate":""},"id":"switch24349"},{"key":8529,"type":"switch","icon":"switch-field","formItemFlag":true,"options":{"name":"isAuto","label":"hp.isHoldAuto","labelAlign":"","defaultValue":true,"columnWidth":"200px","labelWidth":null,"labelHidden":false,"disabled":false,"hidden":false,"customClass":[],"labelIconClass":null,"labelIconPosition":"rear","labelTooltip":null,"switchWidth":40,"activeText":"","inactiveText":"","activeColor":null,"inactiveColor":null,"onCreated":"","onMounted":"","onChange":"\nconst approvedBy = this.getWidgetRef('approvalId')\nif (value) {\n  approvedBy.setHidden(true)\n  approvedBy.setRequired(false)\n} else {\n  approvedBy.setHidden(false)\n  approvedBy.setRequired(true)\n}","onValidate":""},"id":"switch46822"}],"options":{"name":"gridCol74552","hidden":false,"span":5,"offset":0,"push":0,"pull":0,"responsive":true,"md":5,"sm":6,"xs":10,"customClass":[]},"id":"grid-col-74552"},{"type":"grid-col","category":"container","icon":"grid-col","internal":true,"widgetList":[{"key":46028,"type":"input","icon":"text-field","formItemFlag":true,"options":{"name":"actionDelayDay","label":"actionDelayDays","labelAlign":"","type":"text","defaultValue":"","placeholder":"","columnWidth":"200px","size":"","labelWidth":null,"labelHidden":false,"readonly":false,"disabled":false,"hidden":false,"clearable":true,"showPassword":false,"required":true,"requiredHint":"","validation":"number","validationHint":"","customClass":["opacityLabel"],"labelIconClass":null,"labelIconPosition":"rear","labelTooltip":null,"minLength":null,"maxLength":null,"showWordLimit":false,"prefixIcon":"","suffixIcon":"","appendButton":true,"appendButtonText":"Days Delay","appendButtonDisabled":false,"buttonIcon":"","onCreated":"","onMounted":"","onInput":"","onChange":"","onFocus":"","onBlur":"","onValidate":"","onAppendButtonClick":""},"id":"input42434"},{"key":23781,"type":"select","icon":"select-field","formItemFlag":true,"options":{"name":"approvalId","label":"approvedBy","labelAlign":"","defaultValue":"","placeholder":"","columnWidth":"200px","size":"","labelWidth":null,"labelHidden":false,"disabled":false,"hidden":true,"clearable":true,"filterable":true,"allowCreate":false,"remote":false,"automaticDropdown":false,"multiple":false,"multipleLimit":0,"optionItems":[],"required":false,"requiredHint":"","validation":"","validationHint":"","customClass":[],"labelIconClass":null,"labelIconPosition":"rear","labelTooltip":null,"onCreated":"","onMounted":"const _this = this\n$api.post('/nuxeo/identity/users', {}).then(res => {\n  res = res.data.data\n  const result = []\n  res.forEach(item => {\n    if(item.username || item.userId) {\n      result.push({\n        label: item.userId || item.username,\n        value: item.userId || item.username\n      })\n    }\n  })\n  result.sort((a, b) => a.label.localeCompare(b.label))\n  _this.loadOptions(result)\n}).catch(err => {\n})","onRemoteQuery":"","onChange":"","onFocus":"","onBlur":"","onValidate":""},"id":"select73108"}],"options":{"name":"gridCol85279","hidden":false,"span":12,"offset":0,"push":0,"pull":0,"responsive":true,"md":19,"sm":18,"xs":14,"customClass":[]},"id":"grid-col-85279"},{"type":"grid-col","category":"container","icon":"grid-col","internal":true,"widgetList":[{"key":81830,"type":"divider","icon":"divider","formItemFlag":false,"options":{"name":"documentTypeText","label":"dpTable_documentType","columnWidth":"200px","direction":"horizontal","contentPosition":"left","hidden":false,"customClass":[],"onCreated":"","onMounted":""},"id":"divider78087"},{"key":37046,"type":"sub-form","category":"container","icon":"sub-form","widgetList":[{"key":28980,"type":"select","icon":"select-field","formItemFlag":true,"options":{"name":"triggerMetaData","label":"dpTable_triggleMeta","labelAlign":"label-left-align","defaultValue":"","placeholder":"","columnWidth":"200px","size":"","labelWidth":null,"labelHidden":false,"disabled":false,"hidden":false,"clearable":true,"filterable":false,"allowCreate":false,"remote":false,"automaticDropdown":false,"multiple":false,"multipleLimit":0,"optionItems":[],"required":true,"requiredHint":"","validation":"","validationHint":"","customClass":[],"labelIconClass":null,"labelIconPosition":"rear","labelTooltip":null,"onCreated":"","onMounted":"","onRemoteQuery":"","onChange":"","onFocus":"","onBlur":"","onValidate":""},"id":"select26767"},{"key":28980,"type":"select","icon":"select-field","formItemFlag":true,"options":{"name":"documentType","label":"dpTable_documentType","labelAlign":"label-left-align","defaultValue":"","placeholder":"","columnWidth":"200px","size":"","labelWidth":null,"labelHidden":false,"disabled":false,"hidden":false,"clearable":true,"filterable":true,"allowCreate":false,"remote":false,"automaticDropdown":false,"multiple":false,"multipleLimit":0,"optionItems":[],"required":true,"requiredHint":"","validation":"","validationHint":"","customClass":[],"labelIconClass":null,"labelIconPosition":"rear","labelTooltip":null,"onCreated":"","onMounted":"const _this = this\nconst interval = setInterval(() => {\n  const vform = _this.getFormRef()\n  if(vform.globalOptionData.ready) {\n    clearInterval(interval)\n    _this.loadOptions(vform.globalOptionData.fileList)\n  }\n}, 1000)\n","onRemoteQuery":"","onChange":"const _this = this\nconst vform = _this.getFormRef()\nif(!vform.globalOptionData || !vform.globalOptionData.ready) {\n  const interval = setInterval(() => {\n    if(vform.globalOptionData.ready) {\n      clearInterval(interval)\n      setData()\n    }\n  }, 1000)\n  return\n}\n\nsetData(true)\nfunction setData (reset = false) {\n  const docType = vform.globalOptionData.fileList.find(item => item.value === value)\n  const metaList = docType.keywords.reduce((prev,item) => {\n    if(item.type === 'date') prev.push({\n      value: item.name,\n      label: item.name\n    })\n    return prev\n  }, [])\n  \n  let triggerMetaData = _this.getWidgetRef('triggerMetaData' + '@row' + rowId)\n  if(reset) triggerMetaData.setValue('')\n  triggerMetaData.loadOptions(metaList)\n}\n\n","onFocus":"","onBlur":"","onValidate":"  /* sample code */\n  /*\n  if ((value > 100) || (value < 0)) {\n    callback(new Error('error message'))  //fail\n  } else {\n    callback();  //pass\n  }\n  */\n  const _this = this\n  if(value) {\n    console.log()\n    check(value)\n  } else {\n    callback();  //pass\n  }\n  \n  async function check(documentType) {\n    const id = _this.getWidgetRef('id').getValue()\n    let result = await $api.get('/docpal/policy/retentions/documentType/used',{params: {\n      documentType,\n      id\n    }}).then(res => res.data.data)\n    result = result.filter(item => item.policyRetentionId !== id)\n    if(result && result.length > 0) {\n      callback(new Error('tip.documentTypeUsed'))\n    } else {\n      callback();  //pass\n    }\n}"},"id":"select24182"}],"options":{"name":"triggers","showBlankRow":true,"showRowNumber":false,"labelAlign":"label-center-align","hidden":false,"customClass":["rp-sub-form"],"onSubFormRowAdd":"","onSubFormRowInsert":"","onSubFormRowDelete":"","onSubFormRowChange":""},"id":"subform78294"},{"key":60829,"type":"divider","icon":"divider","formItemFlag":false,"options":{"name":"divider94244","label":"event","columnWidth":"200px","direction":"horizontal","contentPosition":"left","hidden":false,"customClass":["mg-t-30"],"onCreated":"","onMounted":""},"id":"divider94244"},{"key":88841,"type":"sub-form","category":"container","icon":"sub-form","widgetList":[{"key":77016,"type":"input","icon":"text-field","formItemFlag":true,"options":{"name":"eventValue","label":"dpTable_extendTime","labelAlign":"label-left-align","type":"text","defaultValue":"","placeholder":"","columnWidth":"200px","size":"","labelWidth":null,"labelHidden":false,"readonly":false,"disabled":false,"hidden":false,"clearable":true,"showPassword":false,"required":true,"requiredHint":"","validation":"number","validationHint":"","customClass":[],"labelIconClass":null,"labelIconPosition":"rear","labelTooltip":null,"minLength":null,"maxLength":null,"showWordLimit":false,"prefixIcon":"","suffixIcon":"","appendButton":true,"appendButtonText":"Days","appendButtonDisabled":false,"buttonIcon":"","onCreated":"","onMounted":"","onInput":"","onChange":"","onFocus":"","onBlur":"","onValidate":"","onAppendButtonClick":""},"id":"input75447"},{"key":79703,"type":"input","icon":"text-field","formItemFlag":true,"options":{"name":"eventLabel","label":"table_label","labelAlign":"label-left-align","type":"text","defaultValue":"","placeholder":"","columnWidth":"200px","size":"","labelWidth":null,"labelHidden":false,"readonly":false,"disabled":false,"hidden":false,"clearable":true,"showPassword":false,"required":true,"requiredHint":"","validation":"","validationHint":"","customClass":[],"labelIconClass":null,"labelIconPosition":"rear","labelTooltip":null,"minLength":null,"maxLength":null,"showWordLimit":false,"prefixIcon":"","suffixIcon":"","appendButton":false,"appendButtonText":"","appendButtonDisabled":false,"buttonIcon":"custom-search","onCreated":"","onMounted":"","onInput":"","onChange":"","onFocus":"","onBlur":"","onValidate":"","onAppendButtonClick":""},"id":"input71045"},{"key":15546,"type":"select","icon":"select-field","formItemFlag":true,"options":{"name":"eventType","label":"rp.eventType","labelAlign":"label-left-align","defaultValue":"","placeholder":"","columnWidth":"200px","size":"","labelWidth":null,"labelHidden":false,"disabled":false,"hidden":false,"clearable":true,"filterable":true,"allowCreate":false,"remote":false,"automaticDropdown":false,"multiple":false,"multipleLimit":0,"optionItems":[{"label":"rp.recentNow","value":"now"},{"label":"rp.extent","value":"extent"}],"required":true,"requiredHint":"","validation":"","validationHint":"","customClass":[],"labelIconClass":null,"labelIconPosition":"rear","labelTooltip":null,"onCreated":"","onMounted":"","onRemoteQuery":"","onChange":"let eventValue = this.getWidgetRef('eventValue' + '@row' + rowId)\nif(value === 'now') {\n  eventValue.setHidden(true)\n  eventValue.setRequired(false)\n} else if (value === 'extent') {\n  eventValue.setHidden(false)\n  eventValue.setRequired(true)\n}","onFocus":"","onBlur":"","onValidate":""},"id":"select92528"}],"options":{"name":"events","showBlankRow":true,"showRowNumber":false,"labelAlign":"label-center-align","hidden":false,"customClass":["rp-sub-form"],"onSubFormRowAdd":"","onSubFormRowInsert":"","onSubFormRowDelete":"","onSubFormRowChange":""},"id":"subform28175"}],"options":{"name":"gridCol82891","hidden":false,"span":24,"offset":0,"push":0,"pull":0,"responsive":false,"md":12,"sm":12,"xs":12,"customClass":[]},"id":"grid-col-82891"}],"options":{"name":"grid42547","hidden":false,"gutter":12,"colHeight":null,"customClass":[]},"id":"grid42547"},{"key":57722,"type":"input","icon":"text-field","formItemFlag":true,"options":{"name":"status","label":"status","labelAlign":"","type":"text","defaultValue":"D","placeholder":"","columnWidth":"200px","size":"","labelWidth":null,"labelHidden":false,"readonly":false,"disabled":false,"hidden":true,"clearable":true,"showPassword":false,"required":false,"requiredHint":"","validation":"","validationHint":"","customClass":[],"labelIconClass":null,"labelIconPosition":"rear","labelTooltip":null,"minLength":null,"maxLength":null,"showWordLimit":false,"prefixIcon":"","suffixIcon":"","appendButton":false,"appendButtonText":"","appendButtonDisabled":false,"buttonIcon":"custom-search","onCreated":"","onMounted":"","onInput":"","onChange":"","onFocus":"","onBlur":"","onValidate":"","onAppendButtonClick":""},"id":"input45741"},{"key":72590,"type":"input","icon":"text-field","formItemFlag":true,"options":{"name":"id","label":"id","labelAlign":"","type":"text","defaultValue":"","placeholder":"","columnWidth":"200px","size":"","labelWidth":null,"labelHidden":false,"readonly":false,"disabled":false,"hidden":true,"clearable":true,"showPassword":false,"required":false,"requiredHint":"","validation":"","validationHint":"","customClass":"","labelIconClass":null,"labelIconPosition":"rear","labelTooltip":null,"minLength":null,"maxLength":null,"showWordLimit":false,"prefixIcon":"","suffixIcon":"","appendButton":false,"appendButtonText":"","appendButtonDisabled":false,"buttonIcon":"custom-search","onCreated":"","onMounted":"","onInput":"","onChange":"","onFocus":"","onBlur":"","onValidate":"","onAppendButtonClick":""},"id":"input90509"}],"formConfig":{"modelName":"formData","refName":"vForm","rulesName":"rules","labelWidth":80,"labelPosition":"top","size":"","labelAlign":"label-left-align","cssCode":".rp-sub-form .sub-form-container .el-row {\n  flex-direction: row-reverse;\n}\n\n.rp-sub-form  .sub-form-table-column, \n.rp-sub-form  .field-header-column {\n  flex: 1;\n}\n.hiddenLabel .el-form-item__label {\n  display: none!important;\n}\n.opacityLabel .el-form-item__label {\n  opacity: 0;\n}\n.mg-t-30{\n  margin-top: 30px;\n}","customClass":[],"functions":"","layoutType":"PC","jsonVersion":3,"onFormCreated":"","onFormMounted":"const _this = this\nif(!this.globalOptionData) this.globalOptionData = {}\nthis.globalOptionData.fileList = []\nthis.globalOptionData.ready = false\ngetDocTypeList()\nasync function getDocTypeList() {\n  const typeList = await $api.post('/nuxeo/types', {}).then(res => res.data.data)\n  typeList.forEach((item) => {\n    const _item = {\n      keywords: item.keywords,\n      value: item.name,\n      label: $t(item.name)\n    }\n    if(!item.isFolder) {\n      _this.globalOptionData.fileList.push(_item)\n    }\n  })\n  setTimeout(() => {\n    _this.globalOptionData.ready = true\n  }, 1000);\n}\n","onFormDataChange":"","onFormValidate":"","saveRemoteOptions":"never","labelFormUniqueName":true,"dataSources":[]}}